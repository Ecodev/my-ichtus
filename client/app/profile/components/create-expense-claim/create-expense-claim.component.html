<div [formGroup]="form" class="padding" fxFlex fxLayout="column" fxLayoutGap="20px">
    <h1 class="mat-headline-4">{{ data.seo.title }}</h1>

    <div fxLayout="column" fxLayout.gt-sm="row" fxLayoutGap.gt-sm="20px">
        <mat-form-field fxFlex.gt-sm>
            <mat-label>Objet de la dépense</mat-label>
            <input matInput formControlName="name" (change)="update()" />
            <mat-error *ngIf="form.get('name')?.hasError('maxlength')">
                Maximum {{ form.get('name')?.errors?.maxlength?.requiredLength }} caractères
            </mat-error>
            <mat-error *ngIf="form.get('name')?.hasError('required')">Requis</mat-error>
        </mat-form-field>

        <mat-form-field *ngIf="form.get('type')?.value !== ExpenseClaimType.refund" id="sector">
            <mat-label>Secteur concerné</mat-label>
            <mat-select formControlName="sector" (selectionChange)="update()">
                <mat-option></mat-option>
                <mat-option *ngFor="let option of expenseClaimService.getSectors()" [value]="option">
                    {{ option }}
                </mat-option>
            </mat-select>
        </mat-form-field>

        <mat-form-field id="amount">
            <mat-label>Montant</mat-label>
            <input matInput type="number" step="0.01" [attr.min]="1" formControlName="amount" (change)="update()" />
            <div matTextSuffix>CHF</div>
            <mat-error *ngIf="form.get('amount')?.hasError('required')">Requis</mat-error>
            <mat-error *ngIf="form.get('amount')?.hasError('min')">Le montant doit être positif</mat-error>
            <mat-error *ngIf="form.get('amount')?.hasError('money')"
                >Le montant doit être un nombre avec un maximum de deux décimales
            </mat-error>
        </mat-form-field>
    </div>

    <mat-form-field>
        <mat-label>Description de la dépense</mat-label>
        <textarea
            matInput
            formControlName="description"
            [cdkTextareaAutosize]="true"
            [cdkAutosizeMinRows]="3"
        ></textarea>
        <mat-hint>Achat, entretien courant, réparation d'un dégat</mat-hint>
    </mat-form-field>

    <div>
        <h2 class="mat-headline-6">Documents justificatifs</h2>
        <div fxLayout="row wrap" fxLayoutGap="10px grid">
            <app-accounting-documents [model]="data.model"></app-accounting-documents>
        </div>
    </div>
</div>

<natural-fixed-button icon="check" (click)="create(false)"></natural-fixed-button>
